import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D


def ccw(A,B,C):
    return (C[1]-A[1]) * (B[0]-A[0]) > (B[1]-A[1]) * (C[0]-A[0])

# Return true if line segments AB and CD intersect
def intersect(A,B,C,D):
    return ccw(A,C,D) != ccw(B,C,D) and ccw(A,B,C) != ccw(A,B,D)

robot_start = (0, 0)
nominal_traj = [
    [0.3568217598824305, -0.5171471124060676, 0.16329977543681473],
[0.33164459564822096, -0.5409552257299538, 0.16094984926541306],
[0.30496911944924965, -0.5633480013626636, 0.15857294453512982],
[0.27688341360949487, -0.5842326791889767, 0.15616387318558883],
[0.24748108355686893, -0.6035224656491011, 0.15371746556371174],
[0.21686081922383235, -0.6211368346018667, 0.1512285885676226],
[0.18512594389194556, -0.637001793473347, 0.1486921640012532],
[0.1523839534102154, -0.6510501147390272, 0.14610318707906264],
[0.11874604860639776, -0.6632215330481448, 0.14345674501807676],
[0.08432666357562167, -0.6734629085387351, 0.1407480356524688],
[0.049242992374881216, -0.681728357108921, 0.13797238600416095],
[0.013614516478247688, -0.6879793486022153, 0.13512527074143435],
[-0.02243746484041106, -0.6921847740306277, 0.13220233045631596],
[-0.05879029922946005, -0.694320983098161, 0.12919938969057954],
[-0.09532043932487878, -0.6943717933982904, 0.1261124746395518],
[-0.13190389260778837, -0.6923284727421265, 0.12293783046259454],
[-0.16841666171335817, -0.6881896961295062, 0.119671938129117],
[-0.20473517405767952, -0.6819614789039491, 0.11631153072927666],
[-0.24073669985018933, -0.673657087635492, 0.1128536091791938],
[-0.2762997577508431, -0.6632969302542929, 0.10929545725146202],
]


human_pose_start = (0, -1.17)
human_pose_end = (-0.08, -0.46)

count = 0

for traj_data in nominal_traj:
    x, y, z  = traj_data

    robot_end = (x, y)
    if intersect(robot_start, robot_end, human_pose_start, human_pose_end):
        count += 1

avg_over_timesteps = (count/len(nominal_traj))
print(str(avg_over_timesteps*100) + "%")